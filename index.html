<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Employee Vibes Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --positive: #a8ff60;
      --negative: #ff8787;
      --project: #60d4ff;
      --bg: #fff9e5;
      --header: #ffd34e;
      --accent: #ffb347;
      --button: #6e64ff;
      --button-hover: #3c3573;
    }
    body {
      background: var(--bg);
      font-family: 'Segoe UI', sans-serif;
      margin: 0; padding: 0;
      display: flex; flex-direction: column; align-items: center;
      min-height: 100vh;
    }
    header {
      background: var(--header);
      width: 100vw;
      text-align: center;
      padding: 20px 0 12px 0;
      font-size: 2em;
      font-weight: bold;
      color: #383300;
      box-shadow: 0 2px 10px #faecc0;
    }
    #container {
      width: 98%;
      max-width: 500px;
      margin: 0 auto;
      background: white;
      padding: 16px;
      border-radius: 17px;
      box-shadow: 0 2px 14px #eadb9a30;
      margin-top: 18px;
    }
    .profile-list {
      margin-bottom: 16px;
    }
    .profile-btn, .action-btn {
      background: var(--button);
      color: white;
      border: none;
      border-radius: 11px;
      padding: 10px 20px;
      font-size: 1em;
      cursor: pointer;
      margin: 3px 5px;
      transition: background 0.18s;
    }
    .profile-btn.selected {
      background: var(--accent);
      color: #383300;
      font-weight: bold;
    }
    .profile-btn:hover, .action-btn:hover {
      background: var(--button-hover);
    }
    #new-profile-form {
      display: flex;
      margin: 12px 0;
      gap: 8px;
    }
    #new-profile-form input { flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #ffd34e; }
    h2 { margin: 0.5em 0 0.4em 0; }
    .notes-list { margin: 0; padding: 0; list-style: none; }
    .note {
      margin-bottom: 10px;
      border-radius: 8px;
      padding: 9px 13px;
      display: flex; flex-direction: column;
      box-shadow: 0 1px 4px #fff9b340;
    }
    .note.positive { background: var(--positive); }
    .note.negative { background: var(--negative); }
    .note.project { background: var(--project); }
    .time { font-size: 0.85em; color: #555; margin-bottom: 2px; }
    .type-label { font-size: 0.92em; font-weight: bold; }
    .note-content { font-size: 1em; margin: 5px 0 0 0; }
    .del-btn {
      margin-left: auto; background: #fd6262; color: white; border: none;
      border-radius: 8px; padding: 3px 11px; cursor: pointer; font-size: 0.9em;
      transition: background 0.17s;
    }
    .del-btn:hover { background: #333; }
    @media (max-width: 500px) {
      #container { padding: 5px; }
      header { font-size: 1.2em; }
    }
  </style>
</head>
<body>
  <header>üéâ Employee Vibes & Projects Tracker üéà</header>
  <div id="container">
    <div id="profiles-section">
      <div class="profile-list" id="profile-list"></div>
      <form id="new-profile-form" autocomplete="off">
        <input id="profile-name-input" type="text" placeholder="Enter employee name" maxlength="28" required>
        <button type="submit" class="action-btn">Create Profile</button>
      </form>
    </div>
    <div id="profile-details" style="display:none">
      <h2 id="profile-title"></h2>
      <form id="note-form" autocomplete="off">
        <select id="note-type">
          <option value="positive">Positive üåü</option>
          <option value="negative">Negative ‚ö†Ô∏è</option>
          <option value="project">Project üìÅ</option>
        </select>
        <input id="note-content" type="text" placeholder="What happened? (max 80 chars)" maxlength="80" required>
        <button type="submit" class="action-btn">Add Note</button>
      </form>
      <ul class="notes-list" id="notes-list"></ul>
    </div>
  </div>
  <script>
    // Utility functions
    function saveProfiles(profiles) {
      localStorage.setItem('emProfiles', JSON.stringify(profiles));
    }
    function loadProfiles() {
      try { return JSON.parse(localStorage.getItem('emProfiles')) || []; }
      catch { return []; }
    }
    // Main state
    let profiles = loadProfiles(); // [{name, notes:[{type,content,time}]}]
    let selectedIdx = null;

    function updateProfileList() {
      const list = document.getElementById('profile-list');
      list.innerHTML = '';
      profiles.forEach((prof, i) => {
        const btn = document.createElement('button');
        btn.textContent = prof.name;
        btn.className = 'profile-btn' + (selectedIdx === i ? ' selected':'');
        btn.onclick = () => { selectedIdx = i; showProfile(); };
        list.appendChild(btn);
      });
      if (profiles.length < 20) list.appendChild(document.createTextNode(''));
    }

    function showProfile() {
      if (selectedIdx === null) return;
      document.getElementById('profile-details').style.display = '';
      const prof = profiles[selectedIdx];
      document.getElementById('profile-title').textContent = 'üßë ' + prof.name;
      renderNotesList(prof.notes || []);
    }

    function renderNotesList(notes) {
      const ul = document.getElementById('notes-list');
      ul.innerHTML = '';
      if (notes.length === 0) {
        ul.innerHTML = '<li style="color:#aaa; font-size:1em; text-align:center; margin-top:9px;">No notes yet.</li>';
        return;
      }
      notes.slice().reverse().forEach((note, idx) => {
        const li = document.createElement('li');
        li.className = 'note ' + note.type;

        const tstr = new Date(note.time).toLocaleString();
        li.innerHTML = `<span class="time">${tstr}</span>
          <span class="type-label">${{
            positive: "Positive üòä",
            negative: "Negative üòï",
            project: "Project üöÄ"
          }[note.type] || note.type}</span>
          <span class="note-content">${note.content.replace(/</g, "&lt;")}</span>
        `;
        const del = document.createElement('button');
        del.textContent = 'Remove';
        del.className = 'del-btn';
        del.onclick = () => {
          if (!confirm('Remove this entry?')) return;
          let realIdx = notes.length - idx - 1;
          profiles[selectedIdx].notes.splice(realIdx, 1);
          saveProfiles(profiles);
          showProfile();
        };
        li.appendChild(del);
        ul.appendChild(li);
      });
    }

    // Event Listeners
    document.getElementById('new-profile-form').onsubmit = function(e){
      e.preventDefault();
      let name = document.getElementById('profile-name-input').value.trim();
      if (!name) return;
      if (profiles.find(e=>e.name.toLowerCase() === name.toLowerCase())) {
        alert('Employee already exists!');
        return;
      }
      if (profiles.length >= 20) {
        alert('Limit: 20 employees.');
        return;
      }
      profiles.push({name, notes:[]});
      saveProfiles(profiles);
      selectedIdx = profiles.length - 1;
      updateProfileList();
      showProfile();
      document.getElementById('profile-name-input').value = '';
    };

    document.getElementById('note-form').onsubmit = function(e){
      e.preventDefault();
      let content = document.getElementById('note-content').value.trim();
      let type = document.getElementById('note-type').value;
      if (selectedIdx===null || !content) return;
      profiles[selectedIdx].notes.push({
        content,
        type,
        time: Date.now()
      });
      saveProfiles(profiles);
      showProfile();
      document.getElementById('note-content').value = '';
    };

    // Initial load
    updateProfileList();

    // If at least one profile, show the first by default
    if (profiles.length) { selectedIdx = 0; showProfile(); }
  </script>
</body>
</html>
